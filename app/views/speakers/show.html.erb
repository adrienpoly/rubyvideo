<%= turbo_refreshes_with method: :morph, scroll: :preserve %>

<div class="container py-8">
  <div class="flex items-start flex-wrap sm:flex-nowrap gap-8 w-full">
    <div class="w-full sm:w-1/3">
      <h1 class="mb-4 flex gap-2" style="view-transition-name: title">
        <%= @speaker.name %>

        <% if @speaker.pronouns.present? && ["dont_specify", "not_specified"].exclude?(@speaker.pronouns_type) %>
          <span class="text-sm content-center text-[#737373]">(<%= @speaker.pronouns %>)</span>
        <% end %>
      </h1>

      <% if @speaker.github.present? %>
        <div class="relative w-fit">
          <%= image_tag @speaker.github_avatar_url(size: 200),
                class: "rounded-full mb-4",
                height: 200,
                width: 200,
                alt: "GitHub picture profile of #{@speaker.github}",
                loading: :lazy %>

          <% if @speaker.verified? %>
            <div class="absolute right-0 top-0 badge badge-accent">Verified</div>
          <% end %>
        </div>
      <% end %>
      <%= render "speakers/about", speaker: @speaker %>
      <%= render "speakers/actions", speaker: @speaker %>
    </div>

    <div class="w-full">
      <% if @grouped_talks.any? %>
        <div role="tablist" class="tabs tabs-bordered">
          <input type="radio" name="talk_type" role="tab" class="tab" aria-label="Grouped" checked="checked" style="width: 150px">
          <div role="tabpanel" class="tab-content border-none rounded-box mt-6">
            <% @grouped_talks.each do |title, talks| %>
              <%= render partial: "talks", locals: {title: title, talks: talks, speaker: @speaker, user_favorite_talks_ids: @user_favorite_talks_ids} %>
            <% end %>
          </div>

          <input type="radio" name="talk_type" role="tab" class="tab" aria-label="Ungrouped" style="width: 150px">
          <div role="tabpanel" class="tab-content border-none rounded-box mt-6">
            <%= render partial: "talks", locals: {talks: @talks, speaker: @speaker, user_favorite_talks_ids: @user_favorite_talks_ids} %>
          </div>
        </div>
      <% else %>
        <%= render partial: "talks", locals: {talks: @talks, speaker: @speaker, user_favorite_talks_ids: @user_favorite_talks_ids} %>
      <% end %>
    </div>
  </div>

  <%= turbo_stream_from @speaker %>
</div>
