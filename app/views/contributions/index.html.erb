<div class="container py-8">
  <h1 class="title">
    <span class="title">Getting Started: Ways to Contribute</span>
  </h1>

  <div role="tablist" class="tabs tabs-lifted mt-6">
    <input type="radio" name="contribution-tabs" role="tab" class="tab" aria-label="Introduction" checked="checked" style="width: 125px">
    <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">
      <article class="prose">
        <h2>Welcome to RubyVideo.dev! ðŸŒŸ</h2>

        <p>We are thrilled to have you here and appreciate your interest in making this resource the best it can be for the community. If you would like to lend a hand, there are various ways you can contribute.</p>

        <p>This page serves as a friendly starting point for anyone looking to get involved but unsure where to begin. Here are some ways you can help:</p>

        <ul>
          <li>Assist in adding missing GitHub handles to speakers</li>
          <li>Help identify speakers based on conference screenshots</li>
          <li>Contribute by adding last names to speakers</li>
          <li>Attach Slides to talks</li>
          <li>Add location information to conferences</li>
          <li>Add event dates to conferences</li>
          <li>Add data for new conferences</li>
        </ul>
      </article>
    </div>

    <input type="radio" name="contribution-tabs" role="tab" class="tab" aria-label="Speakers without GitHub handles" style="width: 275px">
    <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">
      <div class="">
        <h2 class="mb-4">Speakers without GitHub handles</h2>

        <article class="prose mb-6">These speakers are currently missing a GitHub handle. By adding a GitHub handle to their profile, we can enhance their speaker profiles with an avatar and automatically retrieve additional information.</article>

        <div id="speakers" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 min-w-full mb-6">
          <% @speakers_without_github.each do |speaker| %>
            <%= link_to edit_speaker_path(speaker), id: dom_id(speaker), class: "flex justify-between hover:bg-gray-100 p-4 rounded-lg border bg-white", data: {turbo_frame: "modal"} do %>
              <div class="flex items-center">
                <span><%= speaker.name %></span>
              </div>
            <% end %>
          <% end %>

          <% remaining_speakers_count = (@speakers_without_github_count - @speakers_without_github.count) %>

          <% if remaining_speakers_count.positive? %>
            <div class="flex items-center hover:bg-gray-100 p-4 rounded-lg border bg-white">
              <span>and <%= remaining_speakers_count %> more</span>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <input type="radio" name="contribution-tabs" role="tab" class="tab" aria-label="Talks without slides" style="width: 175px">
    <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">
      <div class="">
        <h2 class="mb-4">Talks without slides</h2>

        <article class="prose mb-6">These talks currently do not have slides attached. However, we know that the speaker has an account on Speakerdeck where they usually upload their slides. Feel free to explore if these talks have associated slidedecks on Speakerdeck.com.</article>

        <div id="speakers" class="grid sm:grid-cols-1 lg:grid-cols-2 xl:grid-cols-2 gap-4 min-w-full mb-6">
          <% @talks_without_slides.each do |talk| %>
            <%= link_to edit_talk_path(talk), id: dom_id(talk), class: "hover:bg-gray-100 p-4 rounded-lg border bg-white" do %>
              <div class="flex flex-col">
                <span class="font-bold"><%= talk.title %></span>
                <span><%= talk.speakers.first.name %></span>
              </div>
            <% end %>
          <% end %>

          <% remaining_talks_count = (@talks_without_slides_count - @talks_without_slides.count) %>

          <% if remaining_talks_count.positive? %>
            <div class="flex items-center hover:bg-gray-100 p-4 rounded-lg border bg-white">
              <span>and <%= remaining_talks_count %> more</span>
            </div>
          <% end %>
        </div>
      </div>

    </div>

    <input type="radio" name="contribution-tabs" role="tab" class="tab" aria-label="Events without videos" style="width: 200px">
    <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">
      <div class="">
        <h2 class="mb-4">Events without videos</h2>

        <article class="prose mb-6">This section highlights events that do not have associated videos available. Explore these events to see if the talks weren't recorded or just not yet added the site.</article>

        <div id="events-without-locations" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4 min-w-full mb-6">
          <% Event.left_joins(:talks).where(talks_count: 0).group_by(&:organisation).each do |organisation, events| %>
            <%= content_tag :div, id: dom_id(organisation, "without-videos"), class: "p-4 rounded-lg border bg-white", target: :_blank do %>
              <div class="flex flex-col">
                <h3 class="line-clamp-1"><p>Organisation: <%= link_to organisation.name, organisation, class: "hover:underline" %></p></h3>

                <b class="mt-4 mb-2">Events without videos:</b>

                <% events.each do |event| %>
                  <span><%= link_to event.name, event, class: "hover:underline" %></span>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>

    <input type="radio" name="contribution-tabs" role="tab" class="tab" aria-label="Events without locations" style="width: 200px">
    <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">
      <div class="">
        <h2 class="mb-4">Events without locations</h2>

        <article class="prose mb-6">This section lists events that are missing location information. By adding a location, we can show in which city/country this event took place.</article>

        <div id="events-without-locations" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4 min-w-full mb-6">
          <% Static::Playlist.where(location: nil).group_by(&:__file_path).each do |file_path, events| %>
            <%= link_to "https://github.com/adrienpoly/rubyvideo/edit/main/#{file_path}", id: "event-#{file_path}", class: "hover:bg-gray-100 p-4 rounded-lg border bg-white", target: :_blank do %>
              <div class="flex flex-col">
                <h3 class="line-clamp-1"><pre>Data File: <%= file_path %></pre></h3>

                <b class="mt-4 mb-2">Events missing locations:</b>

                <% events.each do |event| %>
                  <span><%= event.title %></span>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>

    <input type="radio" name="contribution-tabs" role="tab" class="tab" aria-label="Events without conference dates" style="width: 250px">
    <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">
      <div class="">
        <h2 class="mb-4">Events without conference dates</h2>

        <article class="prose mb-6">This section lists events that are missing conference dates. Adding conference dates allows us to show when this event took place, so we could show them in a calendar or similar.</article>

        <div id="events-without-dates" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4 min-w-full mb-6">
          <% Static::Playlist.where(start_date: nil).group_by(&:__file_path).each do |file_path, events| %>
            <%= link_to "https://github.com/adrienpoly/rubyvideo/edit/main/#{file_path}", id: "event-#{file_path}", class: "hover:bg-gray-100 p-4 rounded-lg border bg-white", target: :_blank do %>
              <div class="flex flex-col">
                <h3 class="line-clamp-1"><pre>Data File: <%= file_path %></pre></h3>

                <b class="mt-4 mb-2">Events missing dates:</b>

                <% events.each do |event| %>
                  <span><%= event.title %></span>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>

    <input type="radio" name="contribution-tabs" role="tab" class="tab" aria-label="Add missing events" style="width: 175px">
    <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">
      <div class="">
        <h2 class="mb-4">Add missing events</h2>

        <article class="prose mb-6">
          <p>If you know of an event that's not yet on RubyVideo.dev, please feel free to add it. This includes events in the future, events with unrecorded talks, or events with talks not yet uploaded online.</p>

          <p>We are checking against <a href="https://rubyconferences.org" target="_blank">rubyconferences.org</a> to identify missing events. Below, we will list conferences with video links first, followed by those without a video link.</p>

          <p>If you would like to contribute data for any of the events listed below, please refer to <a href="https://github.com/adrienpoly/rubyvideo/blob/main/docs/contributing.md" target="_blank">this guide</a> to add the event to the site.</p>
        </article>

        <% upstream_conferences = RubyConferences::Client.new.conferences_cached.reverse %>
        <% conference_names = Event.all.pluck(:name) %>
        <% pending_conferences = upstream_conferences.reject { |conference| conference["name"].in?(conference_names) } %>

        <% with_video_link, without_video_link = pending_conferences.partition { |conference| conference["video_link"].present? } %>

        <% conferences_to_index = with_video_link.count + without_video_link.count %>
        <% already_index_conferences = upstream_conferences.count - conferences_to_index %>

        <h3 class="font-bold mb-3">Conferences from RubyConferences.org we already indexed</h3>

        <article class="prose mb-6">
          <p>We already indexed <%= pluralize(already_index_conferences, "conference") %> out of the <%= pluralize(upstream_conferences.count, "conference") %> listed on RubyConferences.org.</p>

          <p>There are <%= pluralize(conferences_to_index, "more conference") %> from RubyConferences.org to be added to RubyVideo.dev.</p>
        </article>


        <h3 class="font-bold mb-3">Conferences from RubyConferences.org with a video link (<%= pluralize(with_video_link.count, "event") %>)</h3>
        <div id="missing-conferences-with-link" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4 min-w-full mb-6">
          <% with_video_link.each do |event| %>
            <%= link_to event["video_link"], id: "#{event["name"]}-pending", class: "hover:bg-gray-100 p-4 rounded-lg border bg-white", target: :_blank do %>
              <div class="flex flex-col">
                <h3 class="line-clamp-1 font-semibold"><%= event["name"] %></h3>

                Videos: <%= URI.parse(event["video_link"]).host %>
              </div>
            <% end %>
          <% end %>
        </div>

        <h3 class="font-bold mb-3">Conferences from RubyConferences.org without a video link (<%= pluralize(without_video_link.count, "event") %>)</h3>
        <div id="missing-conferences-without-link" class="grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4 min-w-full mb-6">
          <% without_video_link.each do |event| %>
            <%= link_to event["url"], id: "#{event["name"]}-pending", class: "hover:bg-gray-100 p-4 rounded-lg border bg-white", target: :_blank do %>
              <div class="flex flex-col">
                <h3 class="line-clamp-1 font-semibold"><%= event["name"] %></h3>

                <% if event["url"].present? %>
                  Website: <%= URI.parse(event["url"]).host %>
                <% else %>
                  Website: -
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
